webpackJsonp([8],{BBAY:function(t,e){},ihCK:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("zNln"),s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"margin-top":"68px"},attrs:{id:"main"}},[i("div",{staticClass:"blogDiv"},[t.blog?i("div",{staticClass:"ownerInfoDiv"},[i("a",{attrs:{href:t.blog.user_url}},[i("img",{staticClass:"img-circle",attrs:{src:t.blog.user_avatar,width:"50px",height:"50px",alt:"头像"}})]),t._v(" "),t.blog.loginStatus&&t.blog.is_self?i("button",{staticStyle:{width:"40px",border:"none","background-color":"#ff8200",height:"20px","font-size":"8px",position:"relative",bottom:"10px","border-radius":"10px"}},[t._v("\n         本人\n      ")]):t._e(),t._v(" "),i("span",{staticClass:"nicknameSpan"},[t._v(t._s(t.blog.user_nickname))]),t._v(" "),i("span",{staticClass:"createTimeSpan"},[t._v("发布于"+t._s(t.blog.create_time))]),t._v(" "),t.blog.loginStatus?t._e():i("button",{staticClass:"followButton",attrs:{title:"关注"},on:{click:t.tipLogin}},[i("i",{staticClass:"el-icon-plus",staticStyle:{"font-weight":"bolder"}}),t._v(" 关注\n      ")]),t._v(" "),t.blog.loginStatus&&!t.blog.is_self&&0===t.blog.relation?i("button",{staticClass:"followButton",attrs:{title:"关注",flag:t.blog.user_id},on:{click:t.addFollow}},[i("i",{staticClass:"el-icon-plus",staticStyle:{"font-weight":"bolder"},attrs:{flag:t.blog.user_id}}),t._v(" 关注\n      ")]):t._e(),t._v(" "),t.blog.loginStatus&&!t.blog.is_self&&8===t.blog.relation?i("button",{staticClass:"followButton",attrs:{title:"回关",flag:t.blog.user_id},on:{click:t.addFollow}},[i("i",{staticClass:"el-icon-plus",staticStyle:{"font-weight":"bolder"},attrs:{flag:t.blog.user_id}}),t._v(" 回关 \n      ")]):t._e(),t._v(" "),t.blog.loginStatus&&!t.blog.is_self&&4===t.blog.relation?i("button",{staticClass:"attention"},[i("i",{staticClass:"el-icon-check"}),t._v(" 已关注\n      ")]):t._e(),t._v(" "),t.blog.loginStatus&&!t.blog.is_elf&&2===t.blog.relation?i("button",{staticClass:"attention",staticStyle:{width:"100px"}},[i("i",{staticClass:"el-icon-check"}),t._v(" 互相关注\n      ")]):t._e()]):t._e(),t._v(" "),t.blog?i("div",{staticClass:"blogInfoDiv"},[i("div",{staticStyle:{"margin-left":"10px",width:"566px","word-break":"break-all","word-wrap":"break-word"}},[t._v(t._s(t.blog.content)+"\n      ")]),t._v(" "),i("div",{staticStyle:{"margin-top":"15px",overflow:"hidden"}},[t._l(t.blog.image,function(e){return"http://43.139.180.101:8080/static/upload/"!==e?i("div",{staticClass:"imageDiv"},[i("img",{staticClass:"image",staticStyle:{cursor:"zoom-in"},attrs:{src:e,title:"放大图像",alt:"图片"},on:{load:t.changeImage,dblclick:t.enlargeImage}})]):t._e()}),t._v(" "),t._l(t.blog.video,function(e){return"http://43.139.180.101:8080/static/upload/"!==e?i("div",{staticClass:"imageDiv"},[i("video",{staticClass:"image",attrs:{src:e,controls:""},on:{canplay:t.changeVideo}})]):t._e()})],2)]):t._e(),t._v(" "),i("div",{staticStyle:{"margin-left":"200px","margin-top":"25px"}},[i("span",{staticClass:"el-icon-chat-dot-square",staticStyle:{"margin-right":"150px",cursor:"pointer","font-size":"20px",color:"#ff82008f"}}),t._v(" "),t.blog&&t.blog.loginStatus?i("span",{staticClass:"iconfont icon-like",class:{likeOrange:1==t.blog.isLike},staticStyle:{cursor:"pointer","font-size":"25px"},attrs:{title:"点赞",flag:t.blog.id},on:{click:t.createLikes}},[0!=t.blog.love_user_number?i("span",{staticStyle:{"font-size":"14px","margin-left":"2px",position:"relative",bottom:"4px"},attrs:{flag:t.blog.id}},[t._v("\n          "+t._s(t.blog.love_user_number)+"\n        ")]):t._e()]):i("span",{staticClass:"iconfont icon-like",staticStyle:{cursor:"pointer","font-size":"25px",color:"grey"},on:{click:t.tipLogin}},[t.blog?i("span",{staticStyle:{"font-size":"14px","margin-left":"2px",position:"relative",bottom:"4px"}},[t._v("\n            "+t._s(t.blog.love_user_number)+"\n          ")]):t._e()])]),t._v(" "),i("hr",{staticStyle:{"margin-bottom":"5px"}}),t._v(" "),t.blog?i("div",{staticClass:"commentDiv"},[i("img",{staticClass:"img-circle",attrs:{src:t.blog.selfAvatar,width:"35px"}}),t._v(" "),t.blog.selfAvatar?i("input",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"commentInput",staticStyle:{width:"90%"},attrs:{type:"text",placeholder:"发布你的评论"},domProps:{value:t.comment},on:{input:function(e){e.target.composing||(t.comment=e.target.value)}}}):i("input",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"commentInput",staticStyle:{width:"100%"},attrs:{type:"text",placeholder:"发布你的评论"},domProps:{value:t.comment},on:{click:t.tipLogin,input:function(e){e.target.composing||(t.comment=e.target.value)}}}),t._v(" "),i("button",{staticClass:"commentButton",class:{controlCommentButton:""===t.comment.trim()},on:{click:t.sendComment}},[t._v("评论\n      ")])]):t._e(),t._v(" "),i("hr"),t._v(" "),i("span",{staticStyle:{"margin-right":"40px",cursor:"pointer"}},[t._v("按热度")]),t._v(" "),i("span",{staticStyle:{cursor:"pointer"}},[t._v("按时间")]),t._v(" "),i("div",{staticStyle:{"margin-top":"15px",width:"600px"},attrs:{id:"commentsContainer"}},t._l(t.commentsResult,function(e,a){return i("div",{key:a,staticStyle:{position:"relative","margin-bottom":"15px"}},[i("a",{attrs:{href:e.homepage}},[i("img",{staticClass:"img-circle commentUserAvatar",attrs:{src:e.avatar,width:"35px"}})]),t._v(" "),i("div",{staticClass:"commentDiv"},[i("span",{staticClass:"commentUserNickname"},[t._v(t._s(e.nickname))]),t._v(" "),i("span",{staticClass:"commentContent"},[t._v("\n            :"+t._s(e.content)+"\n          ")])]),t._v(" "),i("span",{staticClass:"commentCreateTime"},[t._v(t._s(e.createTime.substring(2)))]),t._v(" "),i("span",{staticStyle:{"margin-left":"360px"}},[i("i",{staticClass:"el-icon-s-comment",staticStyle:{cursor:"pointer"},attrs:{ownerId:a,ownerName:e.nickname,title:"回复"},on:{click:t.openReplyModal}}),t._v(" "),t.blog&&t.blog.loginStatus?i("span",{staticClass:"iconfont icon-like",class:{likeOrange:1==e.isLike},staticStyle:{cursor:"pointer","margin-left":"20px","font-size":"18px"},attrs:{title:"点赞",flag:e.commentId,index:a},on:{click:t.createCommentLikes}},[0!=e.loveUserNumber?i("span",{staticStyle:{"font-size":"12px","margin-left":"2px",position:"relative",bottom:"2px"},attrs:{flag:e.commentId,index:a}},[t._v("\n              "+t._s(e.loveUserNumber)+"\n            ")]):t._e()]):i("span",{staticClass:"iconfont icon-like",staticStyle:{cursor:"pointer","margin-left":"20px","font-size":"18px"},attrs:{title:"点赞"},on:{click:t.tipLogin}},[0!=e.loveUserNumber?i("span",{staticStyle:{"font-size":"12px","margin-left":"5px",position:"relative",bottom:"2px"}},[t._v("\n              "+t._s(e.loveUserNumber)+"\n            ")]):t._e()])]),t._v(" "),0!=e.replyNumber?i("p",{staticStyle:{"font-size":"12px",cursor:"pointer",color:"orange","margin-left":"40px"},attrs:{commentIndex:a,commentId:e.commentId},on:{click:t.openDisplayReplyModal}},[t._v("\n          共"+t._s(e.replyNumber)+"条回复\n          "),i("i",{staticClass:"el-icon-caret-bottom",attrs:{commentIndex:a,commentId:e.commentId}})]):t._e()])}),0)]),t._v(" "),t._m(0),t._v(" "),i("div",{attrs:{id:"replyDisplayModal"}},[i("div",{staticStyle:{position:"relative"}},[i("h4",{staticStyle:{"margin-left":"20px","font-weight":"bolder",display:"inline-block"}},[t._v("\n        "+t._s(t.replyNumber)+"条回复\n      ")]),t._v(" "),i("i",{staticClass:"el-icon-close",staticStyle:{position:"absolute",cursor:"pointer",top:"5px",right:"15px","font-size":"20px"},on:{click:t.closeDisplayReplyModal}}),t._v(" "),i("hr")]),t._v(" "),i("div",{staticStyle:{overflow:"auto",height:"500px"}},[t._m(1),t._v(" "),t._m(2),t._v(" "),i("div",{staticClass:"replyDiv"},t._l(t.repliesResult,function(e){return e?i("div",{staticStyle:{position:"relative","margin-left":"20px"}},[i("div",[i("a",{staticStyle:{"text-decoration":"none"},attrs:{href:e.homepage}},[i("span",{staticClass:"commentUserNickname"},[t._v(t._s(e.nickname))])]),t._v(" "),i("span",{staticClass:"commentContent"},[t._v("\n            :"+t._s(e.content)+"\n          ")])]),t._v(" "),i("span",{staticStyle:{"font-size":"12px",color:"#999999"}},[t._v(t._s(e.createTime.substring(2)))]),t._v(" "),t._m(3,!0)]):t._e()}),0)]),t._v(" "),i("hr",{staticStyle:{width:"170px","margin-left":"60px",display:"inline-block"}}),t._v(" "),i("span",{staticStyle:{margin:"0 35px","font-size":"12px",color:"gray"}},[t._v("没有更多回复了")]),t._v(" "),i("hr",{staticStyle:{width:"170px",display:"inline-block"}})]),t._v(" "),i("div",{attrs:{id:"replyModal"}},[i("div",{staticStyle:{position:"relative"}},[i("h4",{staticStyle:{"margin-left":"20px","font-weight":"bolder",display:"inline-block"},attrs:{id:"replayUserNickname"}}),t._v(" "),i("i",{staticClass:"el-icon-close",staticStyle:{cursor:"pointer","font-size":"20px",position:"absolute",right:"15px",top:"5px"},on:{click:t.closeReplyModal}}),t._v(" "),i("hr")]),t._v(" "),i("div",[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reply,expression:"reply"}],staticClass:"replyTextarea",attrs:{placeholder:"发布你的回复"},domProps:{value:t.reply},on:{input:function(e){e.target.composing||(t.reply=e.target.value)}}})]),t._v(" "),i("button",{staticClass:"replyButton",class:{controlCommentButton:""===t.reply.trim()},attrs:{id:"modalReplyButton"},on:{click:t.sendReply}},[t._v("回复\n    ")])]),t._v(" "),i("div",{staticClass:"replyModalBackdrop"})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal fade",attrs:{tabindex:"-1",role:"dialog","aria-labelledby":"myLargeModalLabel",id:"imageModal"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{staticStyle:{"font-size":"35px","margin-right":"10px"},attrs:{"aria-hidden":"true"}},[this._v("×")])]),this._v(" "),e("img",{attrs:{src:"",alt:"图像",id:"originalImage"}})])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"margin-top":"15px",width:"600px"},attrs:{id:"commentsContainer"}},[e("div",{staticStyle:{position:"relative","margin-left":"20px"}},[e("a",{attrs:{id:"modalHomepage"}},[e("img",{staticClass:"img-circle commentUserAvatar",attrs:{id:"modalAvatar",width:"35px"}})]),this._v(" "),e("div",{staticClass:"commentDiv"},[e("span",{staticClass:"commentUserNickname",attrs:{id:"modalNickname"}}),this._v(" "),e("span",{staticClass:"commentContent",attrs:{id:"modalContent"}})]),this._v(" "),e("span",{staticClass:"commentCreateTime",attrs:{id:"modalCreateTime"}}),this._v(" "),e("span",{staticStyle:{"margin-left":"360px",width:"60px"}},[e("i",{staticClass:"el-icon-s-comment",staticStyle:{cursor:"pointer"},attrs:{title:"回复"}}),this._v(" "),e("i",{staticClass:"glyphicon glyphicon-thumbs-up",staticStyle:{"margin-left":"20px"}})])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{"margin-top":"10px","margin-left":"55px"}},[e("span",{staticStyle:{cursor:"pointer","font-size":"12px","font-weight":"bolder"}},[this._v("按热度")]),this._v(" "),e("span",{staticStyle:{cursor:"pointer","font-size":"12px","font-weight":"bolder","margin-left":"20px",color:"orange"}},[this._v("按时间")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticStyle:{"margin-left":"320px",width:"60px"}},[e("i",{staticClass:"el-icon-s-comment",staticStyle:{cursor:"pointer"},attrs:{title:"回复"}}),this._v(" "),e("i",{staticClass:"glyphicon glyphicon-thumbs-up",staticStyle:{"margin-left":"20px"}})])}]};var o=function(t){i("BBAY")},l=i("VU/8")(a.a,s,!1,o,"data-v-3ea457e1",null);e.default=l.exports},zNln:function(t,e,i){"use strict";(function(t){e.a={name:"BlogComment",data:function(){return{blog:null,comment:"",commentsResult:null,repliesResult:null,reply:"",replyNumber:0,likeFlag:null,commentLikeFlag:null,headers:{headers:{token:window.localStorage.getItem("token")}}}},created:function(){var t=this;this.$http.get("http://43.139.180.101:8080/blogs/"+this.$route.params.blogId,this.headers).then(function(e){t.blog=e.data.data[0],e.data.data.splice(0,1),t.commentsResult=e.data.data,console.log(t.blog),console.log(t.commentsResult)}),setInterval(function(){t.$http.get("http://43.139.180.101:8080/comments/"+t.$route.params.blogId).then(function(e){t.commentsResult=e.data.data})},1e4)},methods:{createCommentLikes:function(t){this.commentLikeFlag=Number(this.commentsResult[t.target.getAttribute("index")].isLike),0===this.commentLikeFlag?(console.log("创建点赞信息"),this.commentLikeFlag=1,this.commentsResult[t.target.getAttribute("index")].isLike=1,this.commentsResult[t.target.getAttribute("index")].loveUserNumber+=1):(console.log("删除点赞信息"),this.commentLikeFlag=0,this.commentsResult[t.target.getAttribute("index")].isLike=0,this.commentsResult[t.target.getAttribute("index")].loveUserNumber-=1);var e=new URLSearchParams;e.append("commentId",t.target.getAttribute("flag")),e.append("flag",this.commentLikeFlag),this.$http.post("http://43.139.180.101:8080/likes/comment",e,this.headers).then(function(t){})},createLikes:function(t){this.likeFlag=Number(this.blog.isLike),0===this.likeFlag?(this.likeFlag=1,this.blog.isLike=1,this.blog.love_user_number+=1):(this.likeFlag=0,this.blog.isLike=0,this.blog.love_user_number-=1);var e=new URLSearchParams;e.append("blogId",t.target.getAttribute("flag")),e.append("flag",this.likeFlag),this.$http.post("http://43.139.180.101:8080/likes/blog",e,this.headers).then(function(t){})},openReplyModal:function(e){t("#replyModal").fadeIn(),t(".replyModalBackdrop").fadeIn(),t("#replayUserNickname")[0].innerText="回复@"+e.target.getAttribute("ownerName"),t("#modalReplyButton")[0].setAttribute("ownerId",e.target.getAttribute("ownerId"))},closeReplyModal:function(){t("#replyModal").fadeOut(),t(".replyModalBackdrop").fadeOut(),this.reply=""},closeDisplayReplyModal:function(){t("#replyDisplayModal").fadeOut(),t(".replyModalBackdrop").fadeOut()},openDisplayReplyModal:function(e){var i=this;this.$http.get("http://43.139.180.101:8080/replies/"+e.target.getAttribute("commentId")).then(function(t){console.log(t.data.data),i.repliesResult=t.data.data,i.replyNumber=t.data.data.length}),t("#modalHomepage")[0].href=this.commentsResult[e.target.getAttribute("commentIndex")].homepage,t("#modalAvatar")[0].src=this.commentsResult[e.target.getAttribute("commentIndex")].avatar,t("#modalNickname")[0].innerText=this.commentsResult[e.target.getAttribute("commentIndex")].nickname,t("#modalContent")[0].innerText=":"+this.commentsResult[e.target.getAttribute("commentIndex")].content,t("#modalCreateTime")[0].innerText=this.commentsResult[e.target.getAttribute("commentIndex")].createTime.substring(2),t("#replyDisplayModal").fadeIn(),t(".replyModalBackdrop").fadeIn()},sendReply:function(t){var e=this;if(""!==this.reply.trim()&&this.blog.loginStatus){this.commentsResult[t.target.getAttribute("ownerId")].replyNumber+=1,console.log(this.commentsResult[t.target.getAttribute("ownerId")]);var i={content:this.reply,commentId:this.commentsResult[t.target.getAttribute("ownerId")].commentId,blogId:this.blog.id,blogOwnerId:this.blog.user_id,replyObjectId:this.commentsResult[t.target.getAttribute("ownerId")].ownerId};this.$http({method:"post",url:"http://43.139.180.101:8080/replies",data:i,headers:{token:window.localStorage.getItem("token"),"Content-Type":"application/json"}}).then(function(t){console.log(t.data),3e4===t.data.code?location.href="http://43.139.180.101:8080/homepage":23e3===t.data.code?alert("插入失败"):(e.closeReplyModal(),e.$message({type:"success",message:"回复成功",duration:"700"})),e.reply=""})}},sendComment:function(){var t=this;if(""!==this.comment.trim()&&this.blog.loginStatus){var e=new Date,i=e.getFullYear()+"-"+this.adjustSeconds(e.getMonth()+1)+"-"+this.adjustSeconds(e.getDate())+" "+this.adjustSeconds(e.getHours())+":"+this.adjustSeconds(e.getMinutes())+":"+this.adjustSeconds(e.getSeconds()),a=new FormData;a.append("createTime",i),a.append("blogOwnerId",this.blog.user_id),a.append("blogId",this.blog.id),a.append("content",this.comment),console.log(a),this.$http({method:"post",url:"http://43.139.180.101:8080/comments",data:a,headers:{token:window.localStorage.getItem("token"),"Content-Type":"application/json"}}).then(function(e){if(23001===e.data.code){console.log(e.data);var a={avatar:t.blog.selfAvatar,nickname:t.blog.selfNickname,content:t.comment,homepage:"http://43.139.180.101:8080/u/"+t.blog.selfId+"/blog",createTime:i,media:"",commentId:e.data.data,replyNumber:0,ownerId:t.blog.selfId,isLike:0,loveUserNumber:0};t.commentsResult.unshift(a),console.log(t.commentsResult),t.comment="",t.$message({type:"success",message:"评论成功",duration:"700"})}else 3e4===e.data.code?location.href="http://43.139.180.101:8080/homepage":alert("评论失败")})}},addFollow:function(t){var e=this;this.$http.post("http://43.139.180.101:8080/friends/"+t.target.getAttribute("flag"),{},this.headers).then(function(i){if(23001===i.data.code){var a=document.createElement("button"),s=document.createElement("i");a.style.position="absolute",a.style.left="460px",a.style.width="80px",a.style.border="2px lightgray solid",a.style.backgroundColor="white",a.style.color="lightgray",a.style.fontWeight="lighter",a.style.height="30px",a.style.borderRadius="15px",a.style.cursor="not-allowed",s.className="el-icon-check",4===t.target.innerText.length?(s.innerText=" 互相关注",a.style.width="100px"):s.innerText=" 已关注",a.appendChild(s),"el-icon-plus"===t.target.className?(t.target.parentNode.after(a),t.target.parentNode.remove()):(t.target.after(a),t.target.remove()),e.$message({type:"success",message:"关注成功",duration:"700"})}})},tipLogin:function(){this.$message({duration:"1000",message:"请先进行登录",type:"error"})},changeImage:function(t){var e=t.target,i=e.height/e.width;t.target.width>e.height?(e.width=130,e.height=Math.floor(130*i),e.style.marginTop=(130-e.height)/2+"px",e.style.marginBottom=(130-e.height)/2+"px"):t.target.width<e.height?(e.height=130,e.width=Math.floor(130/i),e.style.marginLeft=(130-e.width)/2+"px",e.style.marginRight=(130-e.width)/2+"px"):(e.width=130,e.height=130,e.style.borderRadius="4px"),e.style.display="inline-block"},changeVideo:function(t){var e=t.target,i=e.clientHeight/e.clientWidth;e.clientWidth>e.clientHeight?(e.width=130,e.height=Math.floor(130*i),e.style.marginTop=(130-e.height)/2+"px",e.style.marginBottom=(130-e.height)/2+"px"):e.clientWidth<e.clientHeight?(e.height=130,e.width=Math.floor(130/i),e.style.marginLeft=(130-e.width)/2+"px",e.style.marginRight=(130-e.width)/2+"px"):(e.width=130,e.height=130,e.style.borderRadius="4px"),e.style.display="block"},enlargeImage:function(e){t("#imageModal").modal({backdrop:"static"});var i=t("#originalImage")[0];i.src=e.target.src,i.width=4*e.target.width,i.height=4*e.target.height},adjustSeconds:function(t){return t<10?"0"+t:t}}}}).call(e,i("7t+N"))}});
//# sourceMappingURL=8.b064543769a7fee3c094.js.map